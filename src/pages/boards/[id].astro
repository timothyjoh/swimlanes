---
import { getDb } from '../../db/init';
import { BoardRepository } from '../../repositories/BoardRepository';
import Board from '../../components/Board';

const id = parseInt(Astro.params.id || '', 10);

if (isNaN(id)) {
  return Astro.redirect('/');
}

const db = getDb();
const boardRepo = new BoardRepository(db);
const board = boardRepo.findByIdWithColumns(id);
---
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{board ? `${board.name} | SwimLanes` : 'Board Not Found | SwimLanes'}</title>
</head>
<body class="bg-gray-50">
  {!board ? (
    <div class="max-w-2xl mx-auto text-center py-12 px-4">
      <h1 class="text-2xl font-bold text-gray-900 mb-4">Board not found</h1>
      <p class="text-gray-600 mb-6">The board you're looking for doesn't exist or has been deleted.</p>
      <a href="/" class="text-blue-600 hover:text-blue-700 font-medium">
        ‚Üê Return to all boards
      </a>
    </div>
  ) : (
    <Board client:load initialBoard={board} />
  )}
</body>
</html>
